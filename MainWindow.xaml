<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="equipment_accounting_system.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:equipment_accounting_system"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Система учета оборудования">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок и панель управления -->
        <Grid Grid.Row="0" Background="{ThemeResource SystemControlBackgroundAltHighBrush}" Padding="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock Text="Система учета оборудования" FontSize="24" FontWeight="Bold"/>
                <TextBlock x:Name="UserInfoTextBlock" Text="Пользователь: " FontSize="12" Foreground="Gray" Margin="0,5,0,0"/>
            </StackPanel>

            <Button x:Name="LogoutButton" 
                    Grid.Column="1"
                    Content="Выход"
                    Click="LogoutButton_Click"
                    HorizontalAlignment="Right"/>
        </Grid>

        <!-- Основная область -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Панель поиска и фильтров -->
            <StackPanel Grid.Row="0" Margin="0,0,0,15">
                <TextBlock Text="Поиск и фильтры" FontSize="16" FontWeight="SemiBold"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBox x:Name="SearchNameTextBox" 
                             Grid.Column="0"
                             Margin="0,0,5,0"
                             PlaceholderText="Поиск по названию"
                             TextChanged="SearchTextBox_TextChanged"/>

                    <TextBox x:Name="SearchManufacturerTextBox" 
                             Grid.Column="1"
                             Margin="5,0,5,0"
                             PlaceholderText="Поиск по производителю"
                             TextChanged="SearchTextBox_TextChanged"/>

                    <TextBox x:Name="SearchLocationTextBox" 
                             Grid.Column="2"
                             Margin="5,0,5,0"
                             PlaceholderText="Поиск по местоположению"
                             TextChanged="SearchTextBox_TextChanged"/>

                    <ComboBox x:Name="StatusFilterComboBox" 
                              Grid.Column="3"
                              Margin="5,0,5,0"
                              PlaceholderText="Фильтр по статусу"
                              SelectionChanged="SearchTextBox_TextChanged"
                              SelectedIndex="0">
                        <ComboBoxItem Content="Все"/>
                        <ComboBoxItem Content="В эксплуатации"/>
                        <ComboBoxItem Content="На ремонте"/>
                        <ComboBoxItem Content="Списано"/>
                        <ComboBoxItem Content="Резерв"/>
                    </ComboBox>

                    <Button x:Name="ClearSearchButton"
                            Grid.Column="4"
                            Margin="5,0,0,0"
                            Content="Очистить"
                            Click="ClearSearchButton_Click"/>
                </Grid>
            </StackPanel>

            <!-- Панель управления -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
                <!-- Кнопки для администратора -->
                <Button x:Name="AddButton" 
                        Content="Добавить"
                        Click="AddButton_Click"
                        Margin="0,0,10,0"
                        Style="{ThemeResource AccentButtonStyle}"/>

                <Button x:Name="EditButton" 
                        Content="Редактировать"
                        Click="EditButton_Click"
                        Margin="0,0,10,0"
                        IsEnabled="False"/>

                <Button x:Name="DeleteButton" 
                        Content="Удалить"
                        Click="DeleteButton_Click"
                        Margin="0,0,10,0"
                        IsEnabled="False"/>

                <Border x:Name="AdminSeparator1" Width="1" Background="{ThemeResource SystemControlForegroundBaseLowBrush}" Margin="10,0"/>

                <Button x:Name="UsersManagementButton" 
                        Content="Пользователи"
                        Click="UsersManagementButton_Click"
                        Margin="10,0,10,0"
                        ToolTipService.ToolTip="Управление пользователями"/>

                <Border x:Name="AdminSeparator2" Width="1" Background="{ThemeResource SystemControlForegroundBaseLowBrush}" Margin="10,0"/>

                <!-- Кнопка просмотра (для всех пользователей) -->
                <Button x:Name="ViewButton" 
                        Content="Просмотр"
                        Click="ViewButton_Click"
                        Margin="0,0,10,0"
                        IsEnabled="False"
                        ToolTipService.ToolTip="Просмотр деталей оборудования"/>

                <TextBlock Text="Сортировка:" VerticalAlignment="Center" Margin="10,0,5,0"/>

                <ComboBox x:Name="SortComboBox" 
                          Width="200"
                          SelectionChanged="SortComboBox_SelectionChanged">
                    <ComboBoxItem Content="Без сортировки" Tag="None"/>
                    <ComboBoxItem Content="По названию (А-Я)" Tag="NameAsc"/>
                    <ComboBoxItem Content="По названию (Я-А)" Tag="NameDesc"/>
                    <ComboBoxItem Content="По цене (возрастание)" Tag="PriceAsc"/>
                    <ComboBoxItem Content="По цене (убывание)" Tag="PriceDesc"/>
                    <ComboBoxItem Content="По дате покупки (старые)" Tag="DateAsc"/>
                    <ComboBoxItem Content="По дате покупки (новые)" Tag="DateDesc"/>
                </ComboBox>

                <TextBlock x:Name="CountTextBlock" 
                           Text="Всего: 0"
                           VerticalAlignment="Center"
                           Margin="20,0,0,0"
                           FontWeight="SemiBold"/>
            </StackPanel>

            <!-- Таблица оборудования -->
            <Grid Grid.Row="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Заголовки таблицы -->
                <Grid Grid.Row="0" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}" Padding="10,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="50"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="130"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="130"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="ID" FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="1" Text="Название" FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="2" Text="Тип" FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="3" Text="Производитель" FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="4" Text="Цена" FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="5" Text="Дата покупки" FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="6" Text="Местоположение" FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="7" Text="Статус" FontWeight="SemiBold"/>
                </Grid>

                <!-- Список оборудования -->
                <ListView x:Name="EquipmentListView"
                          Grid.Row="1"
                          SelectionMode="Single"
                          SelectionChanged="EquipmentListView_SelectionChanged">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="10,8" BorderBrush="{ThemeResource SystemControlBackgroundBaseMediumBrush}" BorderThickness="0,0,0,1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="130"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="130"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="{Binding Id}" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="{Binding Name}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                <TextBlock Grid.Column="2" Text="{Binding EquipmentType}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                <TextBlock Grid.Column="3" Text="{Binding Manufacturer}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                <TextBlock Grid.Column="4" Text="{Binding PriceFormatted}" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="5" Text="{Binding PurchaseDateFormatted}" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="6" Text="{Binding Location}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                <TextBlock Grid.Column="7" Text="{Binding Status}" VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Grid>

        <!-- Статусная строка -->
        <Border Grid.Row="2" 
                Background="{ThemeResource SystemControlBackgroundAltHighBrush}" 
                Padding="20,10">
            <TextBlock x:Name="StatusTextBlock" 
                       Text="Готово"
                       FontSize="12"
                       Foreground="Gray"/>
        </Border>
    </Grid>
</Window>
