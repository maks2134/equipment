# Инструкция по сборке исполняемого файла (.exe)

## Сборка .exe файла для системы учета оборудования

---

## Способ 1: Сборка через Visual Studio (Рекомендуется)

### Шаг 1: Подготовка проекта

1. Откройте проект в **Visual Studio 2022**
2. Убедитесь, что проект успешно компилируется (нажмите **F6** или **Сборка → Собрать решение**)

### Шаг 2: Настройка конфигурации

1. В верхней панели Visual Studio выберите:
   - **Конфигурация**: `Release` (вместо Debug)
   - **Платформа**: `x64` (рекомендуется) или `x86`

### Шаг 3: Публикация проекта

#### Вариант A: Публикация с зависимостями .NET (требует установленный .NET Runtime)

1. В меню выберите: **Проект → Опубликовать** (Project → Publish)
2. В открывшемся окне выберите:
   - **Целевая папка**: укажите путь, куда сохранить файлы (например, `C:\Publish\EquipmentSystem`)
   - **Режим развертывания**: `Зависимый от платформы` (Framework-dependent)
3. Нажмите **"Опубликовать"** (Publish)
4. Дождитесь завершения публикации

**Результат**: Исполняемый файл будет в папке:
```
[Указанная_папка]\win-x64\publish\
```

#### Вариант B: Автономная публикация (со всеми зависимостями, не требует .NET Runtime)

1. В меню выберите: **Проект → Опубликовать** (Project → Publish)
2. В открывшемся окне:
   - Выберите **"Изменить"** (Edit) рядом с профилем публикации
   - В разделе **"Режим развертывания"** выберите: `Автономный` (Self-contained)
   - В разделе **"Целевая среда выполнения"** выберите: `win-x64` (или win-x86)
3. Нажмите **"Сохранить"** и затем **"Опубликовать"**

**Результат**: Исполняемый файл со всеми зависимостями будет в папке:
```
[Указанная_папка]\win-x64\publish\
```
**Размер**: ~100-150 МБ (включает .NET Runtime)

### Шаг 4: Поиск исполняемого файла

После публикации перейдите в папку публикации и найдите файл:
- `equipment_accounting_system.exe` - главный исполняемый файл

---

## Способ 2: Сборка через командную строку

### Шаг 1: Откройте командную строку или PowerShell

Перейдите в папку проекта:
```bash
cd путь\к\проекту\equipment_accounting_system
```

### Шаг 2: Публикация с зависимостями .NET

```bash
dotnet publish -c Release -r win-x64 --self-contained false -p:PublishSingleFile=false
```

**Параметры:**
- `-c Release` - конфигурация Release
- `-r win-x64` - платформа x64 (можно заменить на `win-x86` или `win-arm64`)
- `--self-contained false` - требует установленный .NET Runtime
- `-p:PublishSingleFile=false` - создает несколько файлов

### Шаг 3: Автономная публикация (рекомендуется для распространения)

```bash
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true -p:IncludeNativeLibrariesForSelfExtract=true
```

**Параметры:**
- `--self-contained true` - включает .NET Runtime
- `-p:PublishSingleFile=true` - создает один исполняемый файл
- `-p:IncludeNativeLibrariesForSelfExtract=true` - включает нативные библиотеки

### Шаг 4: Поиск результата

Исполняемый файл будет в папке:
```
bin\Release\net8.0-windows10.0.19041.0\win-x64\publish\
```

---

## Способ 3: Создание установщика MSIX

### Через Visual Studio

1. В Visual Studio выберите: **Проект → Упаковать** (Project → Package)
2. Следуйте инструкциям мастера упаковки
3. Будет создан файл `.msix` для установки приложения через Microsoft Store или вручную

### Через командную строку

```bash
dotnet publish -c Release -r win-x64
msbuild equipment_accounting_system.csproj /t:CreateAppxPackage /p:Configuration=Release /p:Platform=x64
```

---

## Оптимизация размера файла

### Для уменьшения размера автономного приложения:

```bash
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true -p:PublishTrimmed=true -p:TrimMode=link
```

**Параметры:**
- `-p:PublishTrimmed=true` - удаляет неиспользуемый код
- `-p:TrimMode=link` - более агрессивная оптимизация

**Внимание**: Обрезка может вызвать проблемы с рефлексией. Протестируйте приложение после сборки.

---

## Проверка сборки

После сборки:

1. **Проверьте наличие файла**: `equipment_accounting_system.exe`
2. **Запустите файл** двойным кликом
3. **Проверьте работу** всех функций приложения
4. **Убедитесь**, что папка `data` создается и файлы сохраняются

---

## Распространение приложения

### Вариант 1: Зависимое от платформы (требует .NET Runtime)

**Требования для пользователя:**
- Windows 10 версии 1809 или выше
- Установленный .NET 8.0 Runtime

**Распространение:**
- Скопируйте всю папку `publish` пользователю
- Пользователь должен установить .NET 8.0 Runtime с https://dotnet.microsoft.com/download

### Вариант 2: Автономное приложение (не требует .NET Runtime)

**Требования для пользователя:**
- Только Windows 10 версии 1809 или выше

**Распространение:**
- Скопируйте всю папку `publish` пользователю
- Или создайте ZIP-архив с содержимым папки `publish`
- Пользователь может запустить `equipment_accounting_system.exe` без установки .NET

### Вариант 3: MSIX установщик

**Требования для пользователя:**
- Windows 10 версии 1809 или выше

**Распространение:**
- Распространите файл `.msix`
- Пользователь устанавливает через двойной клик или через Microsoft Store

---

## Размеры сборок (приблизительно)

- **Зависимое от платформы**: ~5-10 МБ
- **Автономное (однофайловое)**: ~100-150 МБ
- **Автономное (многофайловое)**: ~80-120 МБ
- **MSIX пакет**: ~100-150 МБ

---

## Решение проблем при сборке

### Ошибка: "Packaged .NET applications cannot be ProcessorArchitecture neutral"

**Решение:**
1. Укажите конкретную платформу: `-r win-x64` или `-r win-x86`
2. В Visual Studio выберите платформу в верхней панели (не AnyCPU)

### Ошибка: "Could not find a part of the path"

**Решение:**
1. Убедитесь, что путь к проекту не содержит специальных символов
2. Попробуйте собрать в другой папке

### Ошибка при запуске собранного .exe

**Решение:**
1. Убедитесь, что используется конфигурация **Release**
2. Проверьте, что все зависимости включены в сборку
3. Для автономной сборки используйте `--self-contained true`

---

## Дополнительные команды

### Просмотр доступных Runtime Identifiers:

```bash
dotnet --list-runtimes
```

### Очистка предыдущих сборок:

```bash
dotnet clean
```

### Восстановление пакетов:

```bash
dotnet restore
```

---

**Успешной сборки!**

